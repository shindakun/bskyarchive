server:
  port: 8080
  host: "localhost"
  # base_url: "https://your-domain.com"  # Optional: Set this for OAuth (required for non-localhost deployments)
  # Or set via environment variable: BASE_URL=https://your-domain.com
  read_timeout: 15s
  write_timeout: 15s
  idle_timeout: 60s
  shutdown_timeout: 30s

  # Security Configuration
  security:
    # CSRF Protection
    csrf_enabled: true
    csrf_field_name: "csrf_token"

    # Request Size Limit (10MB default)
    max_request_bytes: 10485760  # 10MB in bytes

    # Security Headers
    headers:
      x_frame_options: "DENY"
      x_content_type_options: "nosniff"
      x_xss_protection: "1; mode=block"
      referrer_policy: "strict-origin-when-cross-origin"
      content_security_policy: "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; frame-ancestors 'none'; base-uri 'self'"
      strict_transport_security: "max-age=31536000; includeSubDomains"  # Only set when HTTPS enabled

archive:
  db_path: "./data/archive.db"
  media_path: "./data/media"
  max_archive_size_gb: 10
  worker_count: 3
  batch_size: 100

oauth:
  scopes:
    - "atproto"
    - "transition:generic"
    - "transition:chat.bsky"
  session_secret: "${SESSION_SECRET}"
  session_max_age: 604800  # 7 days in seconds

  # Cookie Security (auto-configured based on BASE_URL)
  cookie_secure: "auto"    # auto/true/false - auto sets Secure=true when BASE_URL uses https://
  cookie_samesite: "lax"   # lax (recommended for OAuth compatibility)

rate_limit:
  requests_per_window: 300
  window_duration: 5m
  burst: 10
